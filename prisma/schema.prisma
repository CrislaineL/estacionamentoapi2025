generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id       Int       @id @default(autoincrement())
  nome     String
  email    String    @unique
  senha    String
  avatar   String?
  veiculos Veiculo[]
  estadias Estadia[]
}

model Veiculo {
  placa        String    @id
  tipo         Tipo
  proprietario String
  modelo       String
  marca        String
  cor          String?
  ano          Int?
  telefone     String
  usuarioId    Int?
  estadias     Estadia[]
  usuario      Usuario?  @relation(fields: [usuarioId], references: [id], onDelete: SetNull)
}

enum Tipo {
  CARRO
  MOTO
  VAN
  CAMINHAO
  ONIBUS
}

model Estadia {
  id         Int       @id @default(autoincrement())
  placa      String?
  entrada    DateTime  @default(now())
  saida      DateTime?
  valorHora  Float
  valorTotal Float?
  usuarioId  Int?
  automovel  Veiculo?  @relation(fields: [placa], references: [placa], onUpdate: Cascade, onDelete: SetNull)
  usuario    Usuario?  @relation(fields: [usuarioId], references: [id], onDelete: SetNull)
}
